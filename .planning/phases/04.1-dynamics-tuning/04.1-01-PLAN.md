---
phase: 04.1-dynamics-tuning
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [game.js]
autonomous: false

must_haves:
  truths:
    - "Brand names on cards are comfortably readable during flight on mobile -- player can distinguish Montignac from Montignak without squinting or lucky timing"
    - "Cards still feel satisfying to slash -- they have momentum, not floaty balloon motion"
    - "Difficulty ramp still works -- late-game spawns feel noticeably harder than early-game"
  artifacts:
    - path: "game.js"
      provides: "Tuned physics parameters for readable card flight"
      contains: "GRAVITY = 400"
    - path: "game.js"
      provides: "Capped speed multiplier ramp"
      contains: "1.0 + t * 0.4"
    - path: "game.js"
      provides: "Reduced base launch velocity"
      contains: "canvasHeight * 0.65 + 100"
  key_links:
    - from: "getDifficulty()"
      to: "spawnWatch()"
      via: "speedMultiplier applied to vy and vx"
      pattern: "speedMult"
    - from: "GRAVITY constant"
      to: "update loop"
      via: "w.vy += GRAVITY * dt and h.vy += GRAVITY * dt"
      pattern: "GRAVITY \\* dt"
---

<objective>
Tune 6 physics parameters in game.js so that Vinted listing cards fly slowly enough for brand names to be comfortably readable on mobile, while keeping the slashing gameplay satisfying and the difficulty ramp functional.

Purpose: Cards currently fly too fast for players to read brand names (65ms exposure at late-game). This makes the fake-detection mechanic -- the core gameplay loop -- impossible to engage with. Tuning physics fixes readability without any structural changes.

Output: Updated game.js with tuned GRAVITY, baseVy, vy random range, vx range, speedMultiplier cap, and spawn interval floor.
</objective>

<execution_context>
@/Users/jimmydore/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jimmydore/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04.1-dynamics-tuning/04.1-RESEARCH.md
@game.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Tune card flight physics parameters</name>
  <files>game.js</files>
  <action>
  Change exactly 6 parameter values in game.js. Do NOT change any code structure, logic, or non-physics values. Leave rotation speed and fakeChance untouched.

  1. Line 71 -- GRAVITY constant:
     BEFORE: `var GRAVITY = 600;`
     AFTER:  `var GRAVITY = 400;`
     WHY: Proportional reduction with velocity to maintain arc shape. Without this, reduced velocity would make cards barely rise ("popcorn" effect).

  2. Line 207 -- spawnInterval in getDifficulty():
     BEFORE: `spawnInterval: Math.max(0.3, 1.2 - tEased * 0.9),`
     AFTER:  `spawnInterval: Math.max(0.5, 1.4 - tEased * 0.9),`
     WHY: Slower cards spend longer on screen. Without widening the spawn floor from 0.3s to 0.5s, 4+ cards would overlap at late-game causing visual clutter. Starting interval raised from 1.2s to 1.4s to match.

  3. Line 208 -- speedMultiplier in getDifficulty():
     BEFORE: `speedMultiplier: 1.0 + t * 0.8,`
     AFTER:  `speedMultiplier: 1.0 + t * 0.4,`
     WHY: Caps multiplier at 1.4x instead of 1.8x. The 1.8x multiplier was the primary destroyer of late-game readability (65ms card exposure). Difficulty now comes from faster spawns and more fakes, not raw speed.

  4. Lines 224-225 -- horizontal velocity (vx):
     BEFORE: `(30 + Math.random() * 80) * speedMult` (both directions)
     AFTER:  `(20 + Math.random() * 60) * speedMult` (both directions)
     WHY: Modest reduction in lateral drift for readability. Range goes from 30-110 to 20-80 px/s. Lower priority than vy changes but contributes to overall readability.

  5. Line 228 -- baseVy formula:
     BEFORE: `var baseVy = canvasHeight * 0.9 + 200;`
     AFTER:  `var baseVy = canvasHeight * 0.65 + 100;`
     WHY: Core fix. Reduces launch velocity so cards arc within visible screen instead of flying 1600-2800px above it. On iPhone 14 (844px): baseVy goes from 960 to 649 px/s.

  6. Line 229 -- vy random component:
     BEFORE: `var vy = -(baseVy + Math.random() * canvasHeight * 0.25) * speedMult;`
     AFTER:  `var vy = -(baseVy + Math.random() * canvasHeight * 0.15) * speedMult;`
     WHY: Reduces random velocity spread from 0-211 to 0-127 px/s. Tighter spread means more consistent, predictable arcs.

  Update the inline comments on lines 207-208 to reflect the new value ranges (e.g., "1.4s -> 0.5s" and "1.0x -> 1.4x").

  Do NOT touch:
  - Line 252 rotationSpeed ((Math.random() - 0.5) * 0.5) -- already gentle enough
  - Line 209 fakeChance -- economy not being rebalanced
  - Lines 483/504 split-half rotationSpeed -- these are visual effects, not flight physics
  - Any other game logic, rendering, or scoring code
  </action>
  <verify>
  1. Read back the modified lines and confirm exact values match:
     - GRAVITY = 400
     - spawnInterval: Math.max(0.5, 1.4 - tEased * 0.9)
     - speedMultiplier: 1.0 + t * 0.4
     - vx: (20 + Math.random() * 60)
     - baseVy = canvasHeight * 0.65 + 100
     - vy random: canvasHeight * 0.15
  2. Grep for old values to confirm none remain:
     - No "GRAVITY = 600" anywhere
     - No "canvasHeight * 0.9 + 200" anywhere
     - No "1.0 + t * 0.8" anywhere
     - No "Math.random() * 80" in the vx section (lines 220-230 area)
  3. Verify rotationSpeed on line 252 is UNCHANGED: (Math.random() - 0.5) * 0.5
  </verify>
  <done>All 6 physics parameters updated to research-recommended values. No other code changed. Game file has no syntax errors.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Tuned card flight physics: reduced gravity (600->400), reduced launch velocity (0.9->0.65 multiplier), capped speed ramp (1.8x->1.4x max), widened spawn floor (0.3s->0.5s), reduced horizontal drift, tighter velocity spread. Cards should now arc within the visible screen with brand names readable at all difficulty levels.</what-built>
  <how-to-verify>
  1. Open the game on your phone (https://coupe-des-montres.jimmydore.fr after deploy, or locally)
  2. Start a round and check EARLY GAME (first 15 seconds):
     - Cards should arc through the upper portion of the screen (apex visible, not off-screen)
     - Brand names (Montignac / fake variants) should be easy to read during flight
     - Cards should still feel like they have momentum -- launched, not floating
  3. Continue playing and check LATE GAME (last 15 seconds):
     - Cards should be faster but brand names still distinguishable with effort
     - Screen should not be overcrowded (2-3 cards visible at once, not 4+)
     - Difficulty should feel noticeably harder than early game
  4. Overall feel: Does slashing still feel satisfying? Cards should not feel like slow-motion balloons.
  </how-to-verify>
  <resume-signal>Type "approved" if feel is good, or describe what needs adjusting (e.g., "still too fast", "feels floaty", "too many cards at once")</resume-signal>
</task>

</tasks>

<verification>
1. game.js contains exactly the 6 parameter changes listed above and no other modifications
2. On mobile, brand names are readable during card flight at both early and late game
3. Slashing cards still feels satisfying -- not floaty or boring
4. Late-game spawns feel harder than early-game spawns
</verification>

<success_criteria>
- GRAVITY = 400 (was 600)
- baseVy = canvasHeight * 0.65 + 100 (was canvasHeight * 0.9 + 200)
- vy random = canvasHeight * 0.15 (was canvasHeight * 0.25)
- speedMultiplier caps at 1.4x (was 1.8x)
- spawnInterval floor = 0.5s, start = 1.4s (was 0.3s, 1.2s)
- vx range = 20-80 (was 30-110)
- Rotation speed UNCHANGED
- Player confirms brand readability on mobile
</success_criteria>

<output>
After completion, create `.planning/phases/04.1-dynamics-tuning/04.1-01-SUMMARY.md`
</output>
